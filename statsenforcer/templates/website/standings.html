{% extends "wrappers/wrapper.html" %}
{% load website_extras %}
{% load staticfiles %}
{% block page_css %}
<link href="{% static "css/datatables.min.css" %}" rel="stylesheet">
<link href="{% static "css/datatables-fontawesome.css" %}" rel="stylesheet">
<!--[if !IE]><!-->

<!--<![endif]-->
{% endblock %}
{% block content %}
    <div class="container">
        <div class="card card-nav-tabs">
            <div class="header header-primary">
                <div class="nav-tabs-navigation">
                    <div class="nav-tabs-wrapper">
                        <ul class="nav nav-tabs" data-tabs="tabs">
                            <li class="active">
                                <a href="#league" data-toggle="tab" aria-expanded="true">
                                    League View
                                <div class="ripple-container"></div></a>
                            </li>
                            <li class="">
                                <a href="#conference" data-toggle="tab" aria-expanded="false">
                                    Conference View
                                <div class="ripple-container"></div></a>
                            </li>
                            <li class="">
                                <a href="#division" data-toggle="tab" aria-expanded="false">
                                    Division View
                                <div class="ripple-container"></div></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="tab-content">
                <div class="tab-pane active" id="league">
                    <div class="card">
                        <div class="content">
                            <div class="row">
                                <div class="col-md-12">
                                    <h4 class="text-center">League</h4>
                                    <table id="AMCP-table" class="table full-width">
                                        <thead>
                                          <tr>
                                            <th>Team Name</th>
                                            <th>Games Played</th>
                                            <th>Wins</th>
                                            <th>Losses</th>
                                            <th>Points</th>
                                            <th>Goals For</th>
                                            <th>Goals Against</th>
                                            <th>Streak</th>
                                          </tr>
                                        </thead>
                                        <tbody>
                                          {% for team in teams %}
                                              <tr>
                                                <td style="white-space:nowrap;"><a href='/teams/{{ team.teamName.split|join:"-" }}'>{{ team.teamName }}</a></td>
                                                <td>{{ team.gamesPlayed }}</td>
                                                <td>{{ team.wins }}</td>
                                                <td>{{ team.losses }}</td>
                                                <td>{{ team.points }}</td>
                                                <td>{{ team.goalsScored }}</td>
                                                <td>{{ team.goalsAgainst }}</td>
                                                <td style="color:{{ team.streakCode|streakColor }}">{{ team.streakCode }}</td>
                                              </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="conference">
                    <div class="card">
                        <div class="content">
                            <div class="row text-center">
                                <div class="col-md-12">
                                    <h3>Conference Standings</h3>
                                    <p>{{ formstate }}</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Western" divisionVal="CP" %}
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Eastern" divisionVal="AM" %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="division">
                    <div class="card">
                        <div class="content">
                            <div class="row text-center">
                                <div class="col-md-12">
                                    <h3>Division Standings</h3>
                                    <p>{{ formstate }}</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Central" divisionVal="C" %}
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Metropolitan" divisionVal="M" %}
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Pacific" divisionVal="P" %}
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    {% include "website/division_table.html" with division="Atlantic" divisionVal="A" %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<div id="canvasArea">
    <canvas style="display:none;" id="canvas" width="1000px" height="700px"></canvas>
</div>

{% endblock %}
{% block page_js %}
<script src="{% static "js/datatables.min.js" %}"></script>
<script src="{% static "js/d3.min.js" %}"></script>
<script src="{% static "js/teamColors.js" %}"></script>
<script src="{% static "js/graphs/historicalStandings.js" %}"></script>
<script type="text/javascript" src="{% static "js/graphs/canvg/rgbcolor.js" %}"></script>
<script type="text/javascript" src="{% static "js/graphs/canvg/StackBlur.js" %}"></script>
<script type="text/javascript" src="{% static "js/graphs/canvg/canvg.js" %}"></script>
<script src="{% static "js/graphs/savePNG.js" %}"></script>
<script>
    $(document).ready(function() {

        var data = {{ divisions|safe }};
        var twidth = $("#AMCP-table").width() - 10,
            theight = $("#AMCP-table").height() - 10;
        var AM = data["A"];
        for (var key in data["M"]) {
            AM[key] = data["M"][key];
        }
        var CP = data["C"];
        for (var key in data["P"]) {
            CP[key] = data["P"][key];
        }
        var AMCP = AM;
        for (var key in CP) {
            AMCP[key] = CP[key];
        }
        CreateHistorical("#Ahistorical", data["A"], twidth / 2, theight / 2);
        CreateHistorical("#Mhistorical", data["M"], twidth / 2, theight / 2);
        CreateHistorical("#Chistorical", data["C"], twidth / 2, theight / 2);
        CreateHistorical("#Phistorical", data["P"], twidth / 2, theight / 2);
        savePNG("#AhistoricalButton", "#Ahistorical");
        savePNG("#MhistoricalButton", "#Mhistorical");
        savePNG("#ChistoricalButton", "#Chistorical");
        savePNG("#PhistoricalButton", "#Phistorical");
        CreateHistorical("#AMhistorical", AM, twidth / 2, theight / 2);
        CreateHistorical("#CPhistorical", CP, twidth / 2, theight / 2);
        savePNG("#AMhistoricalButton", "#AMhistorical");
        savePNG("#CPhistoricalButton", "#CPhistorical");

        $('#A-table').DataTable({
            "bPaginate": false,
            "bSort": false
        });
        $('#M-table').DataTable({
            "bPaginate": false,
            "bSort": false
        });
        $('#C-table').DataTable({
            "bPaginate": false,
            "bSort": false
        });
        $('#P-table').DataTable({
            "bPaginate": false,
            "bSort": false
        });

    });
</script>
{% endblock %}
